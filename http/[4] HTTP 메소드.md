

# URI 설계에서 가장 중요한 것은 리소스 식별

## 리소스와 행위를 분리

### 리소스의 의미는 무엇일까?

회원을 등록하고 수정하고 조회하는게 리소스가 아니다!

회원이라는 개념 자체가 리소스 이다.

### 리소스를 어떻게 식별하는게 좋을까?

회원을 등록하고 수정하고 조회하는 것을 모두 배제

회원이라는 리소스만 식별하면 된다. → 회원 리소스를 URI 에 매핑

> API URI 설계를 한다고 하자.
회원 목록 조회 /members
회원 조회 /members/{id}
회원 등록 /members/{id}
회원 수정 /members/{id}
회원 삭제 /members/{id}

**그럼 얘네들을 어떻게 구분하지?**

URI는 리소스만 식별

리소스와 해당 리소스를 대상으로 하는 행위를 분리

→ **HTTP 메서드를 사용하면 돼!**

- **GET:** 리소스 조회
- **POST:** 요청 데이터 처리, 주로 등록에 사용
- **PUT:** 리소스를 대체, 해당 리소스가 없으면 생성
- **PATCH :** 리소스 부분 변경
- **DELETE:** 리소스 삭제
- 기타
HEAD: GET과 동일하지만 메시지 부분을 제외하고 상태줄과 헤더만 반환
**OPTIONS:** 대상 리소스에 대한 통신 가능 옵션을 설명 (주로 CORS에서 사용)
CONNECT : 대상 자원으로 식별되는 서버에 대한 터널을 설정
TRACE: 대상 리소스에 대한 경로를 따라 메시지 루프백 테스트를 수행

# GET

- 리소스 조회
- 서버에 전달하고 싶은 데이터는 쿼리를 통해 전달
- 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 권장하지 않음

![](https://images.velog.io/images/jinii/post/c6b46f1e-8168-4932-aeb6-684591a65dd6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-12-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.27.09.png)

# POST

1. 새 리소스 생성(등록) → 서버가 아직 식별하지 않은 새 리소스 생성
2. 요청 데이터 처리 

단순히 데이터를 생성하거나, 변경하는 것을 넘어서 프로세스를 처리해야 하는 경우
• 예) 주문에서 결제완료 -> 배달시작 -> 배달완료 처럼 단순히 값 변경을 넘어 프로세스의 상태가 변경되는 경우
• POST의 결과로 새로운 리소스가 생성되지 않을 수도 있음
• 예) POST /orders/{orderId}/start-delivery (컨트롤 URI)

1. 다른 메서드로 처리하기 애매한 경우 

예) JSON으로 조회 데이터를 넘겨야 하는데, GET 메서드를 사용하기 어려운 경우
• 애매하면 POST

- 요청 데이터 처리
- 메시지 바디를 통해 서버로 요청 데이터 전달
- 서버는 요청 데이터 처리 → 메시지 바디를 통해 들어온 데이터를 처리하는 모든 기능 수행
- 주로 전달된 데이터로 신규 리소스 등록, 프로세스 처리에 사용

![](https://images.velog.io/images/jinii/post/3e5d9eef-ea01-4af3-9967-0462ea82e528/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-12-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.28.12.png)

# PUT

![](https://images.velog.io/images/jinii/post/66f7e83a-04e7-4439-9c44-2d87865db561/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-12-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.30.30.png)

- 리소스를 대체

**리소스가 있으면 대체, 없으면 생성**

**중요 ! 클라이언트가 리소스를 식별 → 클라이언트가 리소스 위치를 알고 URI 지정 / POST와의 차이이다** 

# PATCH

![](https://images.velog.io/images/jinii/post/efcdb4d6-34a8-447d-a15b-9235f045c181/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-12-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.32.14.png)

PUT 은 완전히 대체 하기 때문에 일부만 변경 하고 싶을 때 사용한다.

# DELETE

![](https://images.velog.io/images/jinii/post/8c8c1dc3-03a7-4cc3-aa56-64cba439e5fd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-12-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.32.20.png)

리소스 제거 

# HTTP 메서드의 속성

- **안전**
1. 호출해도 리소스를 변경하지 않는다.
- **멱등**
1. 한번, 두번, 100 번 호출해도 결과가 같다.
2. POST는 멱등하지 않음!!!  → 정상 응답을 못주었을 때, 같은 요청을 할 수 없음
- **캐시 가능**
1. GET, HEAD정도만 캐시로 사용한다. 왜냐하면 POST, PATCH는 본문 내용까지 캐시 키로 구현해야 하는데 이게 쉽지 않다.
